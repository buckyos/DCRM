# DMC 铭文协议
设计目标是在保持和现有Orindal协议尽量兼容的基础上，能实现DMC的Mint,公共数据铭文的铭刻、吟唱、共鸣


## Mint DMC
使用标准的Orindal协议进行Mint，根据现在部署的BRC20，成功获得210个DMC
我们的扩展增加了“lucky”关键字（最长32个字节），当带有该关键字的交易进入被 区块高度与自己的地址的和被64整除的区块时，用户会得到2100个DMC。lucky mint在未进入正确区块时，蜕化成普通mint,获得上限规定的210个DMC.

```
{"p":"brc-20","op":"mint","tick":"DMC ","amt":"2100","lucky":"dmc-discord"}
```

为了把现在DMC主网的token迁移过来，我们有一个记录在ETH合约里的“DMC销毁公开列表”。说明了lucky的一些特殊值。制定用户用这些特殊值进行mint时，会得到公开列表中说明的DMC数量。该公开列表一旦发布，就不会变化。该列表包含的DMC上限为4000万DMC。

## 铭刻（inscribe）公共数据铭文
"铭文内容包含在揭示交易的输入中，铭文是在其第一个输出的第一个sat上制作的。" 

铭刻公共数据铭文的协议使用Orindal协议里创建NFTs的逻辑，但使用我们约定的metadata.

铭刻时系统会从ETH网络中同步一些公共数据的MetaData过来，作为首次铭刻者，用户也可以写入不可修改的铭文文本（我们鼓励文本内容是对这个公共数据的感受）。

铭刻公共数据需要用户支付数量为n的DMC。
```
n = f(data_size,data_points)*2
```
1. 任何在ETH里无法查询到的公共数据的积分(Points)是1.
2. 用户为铭刻公共数据铭文支付的DMC的98%会进入 DMC Mint Pool，剩余的2%作为手续费进入基金会账户。

Mint数据成功的条件：
a. 一个公共数据只能被铭刻一次。
b. 用户的上一个BTC交易的hash与公共数据的hash满足一定的阈值。其基本逻辑是对任意公共数据，用户总有1/32的概率是可以有资格铭刻的。
c. 在同一个区块里的铭刻并不遵循传统的先到先得效原则，如果在一个区块里同时有多个用户铭刻同一个公共数据，那么和公共数据距离最近的用户可以铭刻成功，其它用户的交易失败，但是不会退回DMC。
d. 铭刻时的amt设置要大于等于上述支付金额要求。小于要求的amt会导致铭刻失败，会退回DMC。

```
{"p":"pi","op":"inscribe","ph":"$hash","text":"$text bind to public data","amt":1000}
```
## 吟唱（Chant）公共数据铭文
吟唱公共数据铭文来获得DMC奖励。
```
吟唱奖励 = f(data_size,data_points) //(一般来说奖励范围从500到50000)
吟唱体力 = f(data_size,data_points) / 4
```

如果吟唱的数据铭文不是自己拥有的，那么无法得到100%的吟唱奖励，会有20%的奖励被转移到铭文的当前拥有者身上
```
{"p":"pi","op":"chant","ph":"xxx","path":[h1,h2,h3,h4 ... ],index:232}
```
吟唱成功的条件
    1.用户拥有该铭文或用户共鸣了该数据铭文
    2.公共数据Hash与进块的块高度满足一定的关系（相当于数据只能在特定的区块吟唱，有间隔）
    3.用户有和数据价值相当的DMC余额 (吟唱体力 )，吟唱体力的限制是为了防止高价值数据通过共鸣被大范围的吟唱
    4.同一个用户在一个区块里，只能吟唱一次

## 转移公共数据铭文的Owner
使用Ordinal的标准NFT方法转移铭文Owner

## 给公共数据铭文定一个 共鸣 （Resonance）价格
公共数据铭文默认不允许共鸣 （共鸣价格是0）
用户需要通过一条特殊的交易来设置共鸣价。设置后数据铭文可以共鸣。共鸣价存在上限：
```
price_limit = f(data_size,data_points)*2
```
下面是协议的示例
```
{"p":"pi","op":"set","ph":"xxx","price":1000}
```


## 与一个公共数据铭文 共鸣（Resonance）
- 向数据铭文的拥有者转账，并设置想要共鸣的公共数据Hash。系统会收取20%的手续费进入基金会账户。
- 转账金额小于该当前设置的铭文共鸣价时，共鸣失败。会退款。
- 共鸣成功后，用户可以在后续吟唱该数据铭文。
- 如果目标用户不拥有该数据的铭文，共鸣失败，会退款。
```
{p:"pi","op":"res","tick":"DMC ","amt":"1000","to":"$dataowner",ph:"$datahash"}
```

## DMC Mint Pool
Mint DMC和吟唱铭文操作都会影响DMC Mint Pool的余额，当DMC Mint Pool余额不足时，上述操作即使成功也无法得到足够的DMC奖励。

## 基金会账户
铭刻和共鸣行为收取的手续费会进入基金会账户，用来对生态的发展进行平衡。包括支持从其他DMC网络转移过来的DMC。

